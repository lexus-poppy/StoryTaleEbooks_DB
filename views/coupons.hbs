<h1>Coupons</h1>
<button type="button" onclick="window.location.reload()">Reset Page</button>

{{! READ table }}
<table id="coupons-table">
    <thead>
        <tr>
            {{#each coupons.[0]}}
            <th>{{@key}}</th>
            {{/each}}
        </tr>
    </thead>

    <tbody>
        {{#each coupons}}
        <tr data-value="{{this.couponID}}">
            <td>{{this.couponID}}</td>
            <td>{{this.couponDiscount}}</td>
            <td>{{this.expirationDate}}</td>
        </tr>
        {{/each}}
    </tbody>

    </table>

{{! CREATE form }}
<h2>Create a Coupon</h2>
<form class="cuForm" id="add-coupon-form" action="/add-coupon-form" method="POST">
    <label for='couponDiscountInput'>Discount Amount ($):</label>
    <input type="number" step="0.01" name="couponDiscountInput" id='couponDiscountInput' required>
    <label for='expirationDateInput'>Expiration Date:</label>
    <input type="date" name="expirationDateInput" id='expirationDateInput' required>
    <input type="submit" value="Add Coupon">
</form>

{{! UPDATE form }}
<h2>Update a Coupon</h2>
<form class='cuForm' id='update-coupon-form' action="/coupons/update" method="POST">
    <label for='update_coupon_id'>Coupon to Update: </label>
    <select name="couponIDInput"  id='update_coupon_id' required>
        <option value="" disabled selected>Select a Coupon ID</option>
        {{#each coupons}}
        <option value='{{this.couponID}}'>ID: {{this.couponID}} (Exp: {{this.expirationDate}})</option>
        {{/each}}
    </select>
    <label for='update_expirationDate'>New Expiration Date: </label>
        <input type='date' name='expirationDateInput' id='update_expirationDate' required />
    <input type="submit" value="Update Coupon">
</form>

{{! DELETE form }}
<h2>Delete a Coupon</h2>
<p>Warning: Deleting a coupon will also remove it from any existing orders.</p>
<form id="delete-coupon-form" method="POST" action="/coupons/delete">
    <label for="delete-coupon-select">Select Coupon to Delete: </label>
    <select name="delete_coupon_id" id="delete-coupon-select" required>
        <option value="" disabled selected>-- Select a Coupon --</option>
        {{#each coupons}}
            {{! Note: use lowercase 'this.couponID' to match your app.get results }}
            <option value="{{this.couponID}}">
                ID: {{this.couponID}} (Exp: {{this.expirationDate}})
            </option>
        {{/each}}
    </select>
    
    <input type="submit" value="Delete Coupon" onclick="return confirm('Are you sure you want to permanently delete this coupon?')">
</form>

{{!--
        Citation for use of AI Tools:
        Date: 02/08/2026
        Prompts used to generate handlebars script
        Write a handlebars script for CS340 OSU Project 3 for the Coupon Entity from the DDL Database (pasted in prompt)
        AI Source URL: https://gemini.google.com/
        Links to an external site.
--}}

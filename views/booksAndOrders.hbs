<h1>Books And Orders</h1>
<button type="button" onclick="window.location.reload()">Reset Page</button>

{{! READ table }}
<table id="b-o-table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Order ID</th>
            <th>Book Title (ISBN)</th>
            <th>Quantity</th>
            <th>Unit Cost</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {{#each booksAndOrders}}
        <tr data-value="{{this.booksAndOrdersID}}">
            <td>{{this.booksAndOrdersID}}</td>
            <td>Order #{{this.orderID}}</td>
            <td>{{this.title}} ({{this.ISBN}})</td>
            <td>{{this.QTY}}</td>
            <td>${{this.cost}}</td>
            <td>
                <button type="button" onclick="deleteLineItem({{this.booksAndOrdersID}})">Remove</button>
            </td>
        </tr>
        {{/each}}
    </tbody>

    </table>

{{! CREATE form }}
<h2>Add Book to Order</h2>
<form action="/booksAndOrders" method="POST">
    <label for="orderIDInput">Order ID: </label>
    <select name="orderIDInput" id="orderIDInput" required>
        <option value="">Select an Order</option>
        {{#each orders}}
        <option value="{{this.orderID}}">Order #{{this.orderID}}</option>
        {{/each}}
    </select>

    <label for="isbnInput">Book: </label>
    <select name="isbnInput" id="isbnInput" required>
        <option value="">Select a Book</option>
        {{#each books}}
        <option value="{{this.ISBN}}">{{this.title}}</option>
        {{/each}}
    </select>

    <label for="qtyInput">Quantity: </label>
    <input type="number" name="qtyInput" id="qtyInput" min="1" required />

    <label for="costInput">Price per Unit ($): </label>
    <input type="number" step="0.01" name="costInput" id="costInput" required />

    <button type="button" onclick="addItem()">Add to Order</button>
</form>

{{!-- Form to add a book to a BRAND NEW order --}}
<h2>Create New Order & Add Book</h2>
<p>This will automatically create a new Order ID for the selected member.</p>
<form id="add-new-order-book-form" action="/booksAndOrders/new-order" method="POST">
    <fieldset>
        <legend>Order Details</legend>
        
        {{!-- Select the Member who is placing the order --}}
    <label for='memberIDInput'>Member: </label>
    <select name='memberIDInput' id='memberIDInput' required>
        <option value='' disabled selected>Select a Member</option>
        {{#each members}}
        <option value='{{this.memberID}}' required>
            {{this.memberID}} - {{this.firstName}} {{this.lastName}}
        </option>
        {{/each}}
        </select>
        {{!-- Select the Book to add --}}
        <label for="isbnInput">Book: </label>
        <select name="isbnInput" id="isbnInput" required>
            <option value="">Select a Book</option>
            {{#each books}}
            <option value="{{this.ISBN}}">{{this.title}}</option>
            {{/each}}
        </select>

        <label for="couponIDInput">Coupon: </label>
        <select name="couponIDInput" id="couponIDInput" required>
            <option value="" disabled selected>Select a Coupon</option>
            {{#each coupons}}
            <option value="{{this.couponID}}">{{this.couponID}} - ${{this.couponDiscount}}</option>
            {{/each}}
        </select>

        <label for="qtyInput">Quantity: </label>
        <input type="number" name="qtyInput" id="qtyInput" min="1" value="1" required>

        <label for="costInput">Line Item Cost: </label>
        <input type="number" name="costInput" id="costInput" step="0.01" required>

        <input type="submit" value="Create Order and Add Book">
    </fieldset>
</form>

{{! UPDATE form }}
<h2>Update Book/Order Line Item</h2>
<form id="update-line-item-form" action="/booksAndOrders/update" method="POST">
    <label for="update_booksAndOrdersID">Line Item ID: </label>
    <select name="booksAndOrdersIDInput" id="update_booksAndOrdersID" required>
        <option value="" disabled selected>Select an ID</option>
        {{#each booksAndOrders}}
        <option value="{{this.booksAndOrdersID}}">ID: {{this.booksAndOrdersID}} (Order #{{this.orderID}})</option>
        {{/each}}
    </select>

    <label for="update_orderID">New Order ID: </label>
    <select name="orderIDInput" id="update_orderID" required>
        <option value="" disabled selected>Select an Order</option>
        {{#each orders}}
        <option value="{{this.orderID}}">Order #{{this.orderID}}</option>
        {{/each}}
    </select>

    <label for="update_ISBN">New Book: </label>
    <select name="isbnInput" id="update_ISBN" required>
        <option value="" disabled selected>Select a Book</option>
        {{#each books}}
        <option value="{{this.ISBN}}">{{this.title}} ({{this.ISBN}})</option>
        {{/each}}
    </select>

    <label for="update_qty">New Quantity: </label>
    <input type="number" name="qtyInput" id="update_qty" min="1" required />

    <button type="submit">Update</button>
</form>

<script src="/js/new_order.js"></script>
<script src="/js/create_books_orders.js"></script>
<script src="/js/delete_books_orders.js"></script>

{{!--
        Citation for use of AI Tools:
        Date: 02/08/2026
        Prompts used to generate handlebars script
        Write a handlebars script for CS340 OSU Project 3 for the Coupon Entity from the DDL Database (pasted in prompt)
        AI Source URL: https://gemini.google.com/
        Links to an external site.
--}}
